# Discrete-Guided Diffusion for Scalable and Safe Multi-Robot Motion Planning

## 基本情報
- arXiv ID: 2508.20095v1 (https://arxiv.org/abs/2508.20095)
- 著者: Jinhao Liang, Sven Koenig, Ferdinando Fioretto
- 所属: University of Virginia, University of California, Irvine
- 投稿日: 2025年08月29日
- カテゴリ: cs.AI, cs.RO

## 簡単に説明すると
この論文は、複数ロボットの動作計画問題（MRMP）において、離散的な多エージェント経路探索（MAPF）と連続的な拡散モデルを融合した革新的なフレームワーク「Discrete-Guided Diffusion（DGD）」を提案しています。
従来手法の課題であったスケーラビリティと軌道品質のトレードオフを解決するため、非凸な構成空間を凸領域に分解し、MAPF解を時空間的構造ガイドとして活用しながら、拡散モデルで高品質な軌道を生成します。
最大100台のロボットまでスケール可能で、複雑な環境での衝突回避と高い成功率を実現しています。

## 1. 研究概要
### 1.1 背景と動機
多ロボット動作計画（MRMP）は、共有環境で動作する複数のロボットに対して衝突回避軌道を生成する基本的な問題です。
自動化倉庫、協調ドローン群、自動運転等の多様な応用において重要でありながら、高次元性と組み合わせ的複雑性により効率的な解決が困難とされています。

従来のアプローチは2つの主要パラダイムに分かれます。最適化ベース手法は滑らかで高品質な経路を生成できますが、ロボット数と障害物数の増加に伴いスケーラビリティが深刻に制限されます。
一方、Multi-Agent Path Finding（MAPF）は空間と時間を離散化することで計算複雑性を大幅に削減し、数百台のロボットまで対応可能ですが、格子ベースの移動と同期時間ステップへの依存により、連続的で動的な環境での適用性が制限されます。

生成モデル、特に拡散モデルの活用も近年探求されていますが、マルチロボット設定への拡張において重要な課題が存在します。
拡散モデルはロボット間の複雑な時空間依存性を捉えながら同時に衝突を回避しなければならず、ロボット数と障害物の増加に伴い問題が高度に扱いにくくなります。

### 1.2 主要な貢献
本研究の主要な貢献は以下の通りです。

離散MAPFと連続拡散生成の新しい統合により、元の非凸MRMP問題を凸構成空間を持つ扱いやすい部分問題の列に分解します。

Priority-based Convex Decomposition（PBD）という新しい分解手法を導入し、重複のない凸領域を保証しながらロボットトラフィックパターンに最適化します。

MAPF解から抽出された時空間依存性を活用し、各部分問題での拡散モデルによる軌道生成を効果的にガイドします。

軽量な制約修復メカニズムを組み込み、制約違反が検出された際のみ実行される投影ガイダンスにより軌道実行可能性を保証します。

## 2. 提案手法
### 2.1 手法の概要
DGD（Discrete-Guided Diffusion）フレームワークは、スケーラビリティの課題と高次元空間での制約満足と軌道品質の課題に対処する4段階のアプローチを採用しています。

第1段階のPriority-based Convex Decomposition（PBD）では、非凸な自由構成空間を重複しない凸領域で近似し、問題分解を可能にします。
従来のVisibility Clique Cover（VCC）アルゴリズムの重複領域問題を解決し、ロボットトラフィック優先の分解により効率性を大幅に向上させます。

第2段階の時空間割り当てでは、MAPF解から抽出された時空間依存性を活用して各凸領域への進入・退出イベントを決定します。
これにより空間的に分離された部分問題間の時間的結合を解決し、グローバル実行可能性を保証します。

第3段階では、MAPF解により導かれた拡散ベース軌道生成により、各部分問題で高品質軌道を生成します。
第4段階の制約認識拡散改良では、実行不可能な軌道を軽量投影メカニズムにより修正し、制約満足を強制します。

### 2.2 技術的詳細
Priority-based Decomposition（PBD）は、計算幾何学技術に基づく新しい分解アプローチです。
Hertel-Mehlhornアルゴリズムにインスパイアされ、非重複凸領域を保証しながらロボットトラフィックパターンに最適化された分割を生成します。

アルゴリズムは2段階で動作します。
まず、構成空間の三角分割をO(|V|log|V|)時間で実行し、次にMAPF解に基づく最高ロボットトラフィックを持つ領域を接続するエッジを優先しながら、隣接する三角形をマージするため対角線を反復的に除去します。

MAPF駆動時空間割り当てでは、離散MAPF解が本質的に粗い時空間衝突スケジュールをエンコードしているという重要な観察を活用します。
各ロボットと領域に対して、退出イベント（時刻t_outと位置π_out）と進入イベント（時刻t_inと位置π_in）を抽出し、構造化された遷移集合を構築します。

拡散ベース軌道生成では、勾配ベース誘導を障害物と他ロボット回避のペナルティ項として組み込みます。
各部分問題が凸ドメインで定義されるため、ユークリッド投影演算子を効率的に統合し、中間サンプルを実行可能集合に投影できます。

### 2.3 新規性
本研究の新規性は以下の点にあります。

離散と連続のハイブリッドアプローチにより、MAPFの構造的スケラビリティと拡散モデルの軌道品質を効果的に組み合わせています。

Priority-based Decompositionは、従来の重複領域問題を解決し、ロボットトラフィックを考慮した効率的な分解を実現します。

時空間依存性の抽出と活用により、離散解の構造情報を連続軌道生成の効果的ガイダンスとして利用します。

軽量制約修復メカニズムにより、グローバル投影の高い計算コストを回避しながら実行可能性保証を提供します。

## 3. 実験結果
### 3.1 実験設定
評価は2つの実験設定で実施されました。
実行可能性・効率性・品質評価では、4つの代表的マップタイプ（基本・密集・部屋・棚レイアウト）で6種類のロボット数（3、6、9、12、15、18台）を対象とし、各設定で25のインスタンスを評価しました。

スケーラビリティ評価では、100を超える異種障害物を含む大規模マップで最大100台のロボットまでの実験を実施し、高次元で密集した環境での実行可能性と堅牢性を検証しました。

評価指標として、成功率（900秒制限内での衝突なし解決の割合）、実行時間、経路長、加速度を使用し、軌道品質と計算効率性の両面から性能を測定しました。

### 3.2 主要な結果
実験結果では、DGDが最先端の拡散ベースベースライン手法に対して優れた性能を実証しました。

成功率において、DGDは複雑な環境で一貫して高い成功率を達成しました。
基本マップでは最大18台のロボットで96-100%の成功率を維持し、密集環境でも18台で76%の成功率を達成しました。
より制約の厳しい部屋・棚環境では、競合手法が12台以上で一貫して失敗する中、DGDは18台で84-100%の成功率を実現しました。

実行時間においては、成功した場合のランタイムが競合手法と競争力を持ちます。
複雑なシナリオでDGDのみが成功する場合、その時間コストは問題の困難さを考慮すれば妥当です。

経路長については、MPDやMMDと同程度の品質を維持しています。
より困難なシナリオでの平均経路長の若干の増加は、他手法が失敗する中でDGDが成功を収めることによるものです。

### 3.3 既存手法との比較
Motion Planning Diffusion（MPD）は成功時には最低ランタイムと経路長を達成しますが、3台を超えるロボットを含む複雑シナリオでは一貫して実行可能解の生成に失敗します。

Multi-robot Motion Planning Diffusion（MMD）はMPDより大幅に改善し、基本マップで18台まで高成功率を維持しますが、制約の厳しい環境での性能が急激に低下します。
明示的協調メカニズムの欠如により、狭い通路での渋滞とデッドロックが発生します。

Simultaneous MRMP Diffusion（SMD）は現在の最先端手法ですが、6台での単純シナリオに限定され、より多くのロボットや複雑環境では計算要求により失敗します。

これに対してDGDは、分解戦略により各部分問題の次元削減を実現し、大規模問題でも効率的に動作します。

## 4. 実用性評価
### 4.1 実装の容易性
DGDフレームワークは、既存のMAPFアルゴリズムと拡散モデルを組み合わせる構造となっており、各コンポーネントが独立して開発・改善可能です。
Priority-based Decompositionは標準的な計算幾何学ライブラリで実装でき、MAPF解析も既存ソルバーで対応可能です。

4段階のパイプラインは明確に分離されており、モジュール式設計により保守性と拡張性が高く評価できます。
制約修復メカニズムも軽量設計により、実装とデバッグが比較的容易です。

### 4.2 計算効率
分解戦略により、グローバルな高次元最適化の代わりに複数の低次元部分問題を並列処理でき、計算効率が大幅に向上します。
PBDによる冗長領域の最大32.6%削減は、必要な拡散モデル呼び出し数の直接的削減につながります。

MAPF解の構造的ガイダンス活用により、純粋なノイズからの開始より効率的なサンプリングが実現され、収束時間が短縮されます。
制約修復は問題発生時のみ実行される設計により、平均的な計算オーバーヘッドが最小化されています。

### 4.3 応用可能性
自動化倉庫、協調ドローン群、自動運転車群等の実世界応用において高い可能性を示します。
100台までのスケーラビリティは実用的な多ロボットシステムの要求を満たします。

フレームワークの汎用性により、異なる環境や制約条件への適応が可能です。
Priority-based Decompositionは環境特性に応じてカスタマイズ可能で、様々なドメインへの転用が期待されます。

## 5. まとめと所感
### 5.1 論文の意義
本論文は、多ロボット動作計画分野において離散と連続アプローチの効果的な統合という重要な breakthrough を達成しています。
従来のスケーラビリティと軌道品質のトレードオフ問題に対する実用的解決策を提示し、理論的基盤と実証的検証の両面で堅実な貢献を行っています。

Priority-based Decompositionという新しい空間分解手法は、計算幾何学における実用的進歩として評価できます。
時空間依存性の抽出と活用は、離散最適化と連続生成モデルの橋渡しとして独創的なアイデアです。

最大100台という現実的なスケーラビリティの実証は、研究室レベルを超えた実用的価値を示しており、産業応用への道筋を明確に提示しています。

### 5.2 今後の展望
今後の発展方向として、より柔軟な部分問題分割を生成する分解プロセスの改良が期待されます。
隣接部分領域間の相互作用を組み込む拡張により、完全軌道全体での時間的・空間的一貫性の向上が可能でしょう。

動的環境や時変制約への対応、異なる動的特性を持つ異種ロボット群への拡張等も重要な研究方向です。
リアルタイム性能の向上と、より複雑な物理制約（非ホロノミック制約等）への対応も実用化において重要な課題となります。

また、強化学習との組み合わせによる適応的計画、不確実性下での堅牢な動作計画等、より高度な応用への拡張可能性も期待されます。