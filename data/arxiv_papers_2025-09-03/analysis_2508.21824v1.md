# DriveQA: Passing the Driving Knowledge Test

## 基本情報
- arXiv ID: 2508.21824v1 (https://arxiv.org/abs/2508.21824)
- 著者: Maolin Wei, Wanzhou Liu, Eshed Ohn-Bar
- 所属: Boston University, Washington University in St. Louis
- 投稿日: 2025年08月29日
- カテゴリ: cs.AI, cs.LG

## 簡単に説明すると
自動運転技術の発展に伴い、AIシステムが人間と同じように運転知識テストに合格できるかという重要な問題に取り組んだ研究です。
研究チームは、アメリカ全50州とワシントンD.C.の公式運転手帳を基に、テキストベース（DriveQA-T）と視覚ベース（DriveQA-V）の包括的なベンチマークデータセットを構築しました。
このデータセットは、基本的な交通ルールから複雑な優先権判断、交通標識認識まで、実際の運転免許試験に相当する幅広い知識を評価します。
実験結果により、最新のLLMやMLLMでも数値推論や複雑な交通状況における判断で大きな弱点を持つことが明らかになりました。
プロジェクトページ: https://driveqaiccv.github.io

## 1. 研究概要
### 1.1 背景と動機
安全な交通環境での運転には、視覚情報の認識だけでなく交通法規の理解と規則に従った判断が必要です。
人間の運転手は運転許可の取得前に、交通法規、優先権ルール、複雑な運転場面に関する包括的な知識テストに合格します。

近年、マルチモーダル大規模言語モデル（MLLM）が汎用推論モデルとして注目されており、自動運転システムへの統合が進んでいます。
しかし、既存の自動運転ベンチマークは主に空間認識や基本的な計画タスクに焦点を当てており、多様な交通法規の理解と遵守能力は十分に評価されていませんでした。

この研究の動機は、現在のMLLMが人間の運転手と同じ知識テストにどの程度対応できるかを体系的に評価することにあります。
商用システム（Tesla Full Self-Drivingなど）でも交通ルール解釈に課題があるという報告が多数存在し、この評価の重要性が浮き彫りになっています。

### 1.2 主要な貢献
本研究では以下の3つの重要な貢献をしています。

第一に、大規模で包括的なベンチマーク「DriveQA」を構築しました。
テキストベース（DriveQA-T）26,000問と視覚ベース（DriveQA-V）448,000問を含み、19の質問カテゴリと220種類の交通標識をカバーしています。
データ生成には合成的手法を用いてCARLAシミュレーターを拡張し、制御された変動（カメラ視点、天候、時刻など）を実現しました。

第二に、高性能なLLMとMLLMに対する体系的な評価を実施しました。
その結果、これらのモデルは基本的な交通ルールでは良好な性能を示すものの、数値精度、優先権推論、空間認識、環境感度において重大な弱点があることを発見しました。

第三に、DriveQAでの事前訓練の有効性を実証しました。
テキストと合成データのみで訓練したモデルが、nuScenesやBDDなどの実世界運転タスクで性能向上を示し、理論と実践を橋渡しする可能性を示しました。

- 包括的な運転知識ベンチマークデータセットの構築
- 最先端AIモデルの交通ルール理解能力の体系的評価
- 合成データから実世界タスクへの有効な転移の実証

## 2. 提案手法
### 2.1 手法の概要
DriveQAは、運転知識を包括的に評価するために設計された二段階のアプローチです。

第一段階では、テキストベースの質問応答データセット（DriveQA-T）を構築しました。
アメリカ全50州とワシントンD.C.の公式運転手帳51冊を収集し、GPT-4oを用いて26,000の質問応答ペアを自動生成しました。
各質問には正解の説明が含まれており、モデルの推論能力評価が可能です。
データは5つの主要カテゴリに分類され、交通信号、駐車、規制、標識、記号などが含まれます。

第二段階では、視覚ベースの拡張（DriveQA-V）を実施しました。
運転知識テストの一部は交通標識や優先権に関する図解を含むため、CARLAシミュレーターを拡張して220種類のアメリカの交通標識3Dモデルを追加しました。
制御された環境変動（視点、天候、時刻、距離）により448,000のマルチモーダル質問応答ペアを生成し、さらにMapillarayの実世界データも活用しました。

### 2.2 技術的詳細
データ構築の技術的プロセスは以下の通りです。

質問タイプの分類では、階層クラスタリングを用いてBERT埋め込みベクトル空間で意味的に一貫したグループを形成しました。
KeyBERTを使用して各クラスタの記述的キーワードを抽出し、19の具体的な質問タイプに分類しました。

評価手法として、Chain of Thought（CoT）推論とRetrieval-Augmented Generation（RAG）技術を採用しました。
CoT推論では、複数車両や規則ベースの場面で論理的整合性をテストします。
RAGでは、全米運転手帳からの検索コーパスを構築し、各質問に対して関連コンテキストを提供することで回答精度を向上させています。

ファインチューニングでは、LoRA（Low-Rank Adaptation）を用いて計算効率の良いパラメータ更新を実現しました。
低ランク更新をトランスフォーマー層の重み行列に導入することで、大規模な計算資源を必要とせずに特化タスクへの適応を可能にしています。

### 2.3 新規性
既存の自動運転ベンチマークと比較して、DriveQAの新規性は以下の点にあります。

第一に、交通法規理解に特化した包括的評価です。
従来のベンチマーク（nuScenes-QA、DriveLMなど）は主に場面理解と基本的な計画に焦点を当てていましたが、DriveQAは実際の運転知識テストと同様の幅広い規制遵守を評価します。

第二に、制御された合成データ生成アプローチです。
CARLAシミュレーターの拡張により、稀な交通標識や複雑な優先権場面を系統的に生成し、実世界データでは取得困難なロングテール事象をカバーしています。

第三に、テキストと視覚の統合評価フレームワークです。
人間の運転知識テストと同様に、文章による規則理解と視覚による場面認識の両方を評価し、マルチモーダル推論能力を包括的に測定します。

第四に、実世界タスクへの転移可能性の実証です。
合成データでの訓練が実世界の軌道予測や行動推論タスクの性能向上につながることを示し、シミュレーションから実環境への知識転移の可能性を実証しました。

## 3. 実験結果
### 3.1 実験設定
実験では多様なLLMとMLLMを評価対象としました。
オープンソース系列としてGemma-2（2B, 9B）、Llama-3.1（8B）、Llama-3.2（3B）、Phi-3.5-mini（3.8B）を使用しました。クローズドソースモデルとしてGPT-4oを評価しました。
マルチモーダルモデルではMini-InternVL（2B）、LLaVA-1.5（7B）、LLaVA-1.6-mistral（7B）、VILA-1.5（8B）を対象としました。

評価指標として、DriveQA-TおよびDriveQA-Vでは正答率を主要指標とし、DriveQA-Tではさらに推論品質評価のためBLEU-4とROUGE-Lスコアを用いました。
4つの異なるプロンプト構造（基本、CoT、RAG、CoT+RAG）を用いて、推論支援と文脈提供の効果を検証しました。

実世界への転移性評価では、Mapillary（1,303画像、166標識タイプ）、nuScenes軌道予測タスク、BDD-OIAデータセットを使用しました。

### 3.2 主要な結果
DriveQA-Tにおける結果では、基本的な交通ルールで良好な性能を示す一方、特定カテゴリで深刻な限界が明らかになりました。

GPT-4oは最高性能（CoT+RAGで91.96%）を達成しました。ファインチューニング後のGemma-2（9B）やLlama-3.1（8B）も87%超の高い正答率を示しました。
しかし、「速度・距離制限」、「駐車」、「交差点優先権」などの困難なカテゴリでは、ファインチューニング前では20-30%台の低い性能を示し、数値推論と複雑な状況判断に重大な弱点を持つことが判明しました。

CoT推論とRAGの効果は明確で、両手法の組み合わせにより一貫して性能向上が見られました。
ファインチューニングにより大幅な改善が達成されましたが、数値に関する質問（アルコール濃度、速度制限など）では依然として課題が残りました。

DriveQA-Vでは、より深刻な性能低下が観察されました。
オフザシェルフモデルでは、GPT-4o（75.29%）を除いて大部分が25%のランダム推測レベルを下回りました。
特に交差点シナリオで困難を示し、一人称の視点画像での性能が特に低くなりました。

ファインチューニング後は劇的な改善が見られ、Mini-InternVL（86.59%）やLLaVA-1.6-mistral（83.66%）が良好な結果を示しました。
しかし、規制標識や警告標識の一部（遊び場、トラウマセンター、ゴルフカートなど）では依然として困難を示し、細かい視覚識別能力の限界が明らかになりました。

### 3.3 既存手法との比較
実世界データセットでの転移性評価により、DriveQAの有効性が実証されました。

Mapillaryデータセットでは、DriveQAでファインチューニングしたモデルが一貫して性能向上を示し、Mini-InternVLでは57.25%から68.61%への改善が見られました。

nuScenes軌道予測では、DriveQA事前訓練により平均L2エラーが2.98mから2.71mに減少し、合成データが実世界タスクに有効に転移することが示されました。

BDD-OIAでの行動推論・説明タスクでは、DriveQA事前訓練とBDD-OIAファインチューニングの組み合わせで最高性能（F1スコア0.7334）を達成しました。

これらの結果は、既存の知覚重視ベンチマークでは評価されない交通ルール理解能力の重要性を示し、DriveQAが実用的な自動運転システム開発に寄与する可能性を実証しています。

## 4. 実用性評価
### 4.1 実装の容易性
DriveQAの実装は比較的容易で、研究者や開発者にとってアクセシブルな設計となっています。

データセットはオープンソースとして公開されており、標準的な機械学習フレームワーク（PyTorch、Transformersライブラリなど）で直接利用可能です。
CARLAシミュレーターの拡張も詳細にドキュメント化されており、追加の3D交通標識アセットとスクリプトが提供されています。

ファインチューニングではLoRA手法を採用しているため、大規模なGPUリソースを必要とせず、研究機関レベルの計算環境でも実行可能です。
評価プロトコルも明確に定義されており、新しいモデルの性能評価を容易に実施できます。

ただし、完全なベンチマーク実行には相当な計算時間が必要で、特に448,000問のDriveQA-V全体の評価は数十時間から数日を要する可能性があります。

### 4.2 計算効率
計算効率の観点では、実用的な範囲内で運用可能ですが、規模の大きさによる課題もあります。

LoRAファインチューニングにより、フル微調整と比較して大幅な計算コスト削減が実現されています。
2Bパラメータモデルでは数時間、9Bパラメータモデルでも24時間以内でのファインチューニングが可能です。

推論時の計算コストは標準的なMLLMと同等で、GPT-4oレベルの性能を要求する場合はAPIコストが発生しますが、オープンソースモデルを用いることで実用的なコストでの運用が可能です。

ただし、DriveQA-Vの大規模データセット（68万画像）による評価では、メモリ使用量と処理時間の最適化が必要になる場合があります。
バッチ処理や段階的評価により、限られたリソース環境でも実行可能な工夫が施されています。

### 4.3 応用可能性
DriveQAの応用可能性は多岐にわたり、自動運転技術の発展に重要な貢献が期待されます。

直接的な応用として、自動運転システムの交通ルール遵守能力向上があります。
実験結果が示すように、DriveQA事前訓練により実世界タスクでの性能向上が実現されており、商用自動運転システムの安全性向上に寄与する可能性があります。

教育分野では、運転教育システムや訓練シミュレーターでの活用が考えられます。
人間の運転手教育における弱点特定や、個別化された学習プログラムの開発に応用できます。

研究分野では、MLLMの限界理解と改善方向の指針として活用できます。
数値推論、空間認識、マルチモーダル統合などの具体的な弱点が明確化されており、これらの課題に特化した手法開発の基盤となります。

国際展開では、アメリカ中心の現在の構成から他国の交通法規への拡張により、グローバルな自動運転技術の標準化に貢献する可能性があります。

規制・標準化の観点では、自動運転システムの安全性の評価基準として活用され、業界標準ベンチマークとしての役割も期待されます。

## 5. まとめと所感
### 5.1 論文の意義
この研究は自動運転技術の安全性評価において画期的な貢献を成し遂げています。

最も重要な意義は、従来の知覚・認識中心の評価から、実際の運転に必要な法規理解・遵守能力の体系的評価への転換点を示したことです。
人間の運転免許試験と同等の知識要求水準を設定することで、AIシステムの実用性を現実的な基準で測定する新しいパラダイムを確立しました。

技術的な意義として、高性能なMLLMにおける具体的な弱点を明確化したことが挙げられます。
数値推論の困難さ、複雑な優先権判断での限界、視覚による空間認識の不備など、これまで定量的に把握されていなかった問題点を実証的に示しました。

方法論的な貢献では、合成データと実世界データの効果的な組み合わせを実現し、シミュレーションベースの知識が実際の運転タスクに転移可能であることを示しました。
これは、稀少事象や危険場面のデータ不足という自動運転分野の根本的課題に対する有効なアプローチを提示しています。

社会的意義では、自動運転システムの透明性と説明可能性の向上に寄与しています。
システムがどの交通ルールを理解し、どこで判断を誤る可能性があるかを明確化することで、技術者と規制当局、一般市民間の信頼構築に貢献する可能性があります。

### 5.2 今後の展望
本研究を基盤として、複数の重要な発展方向が期待されます。

技術的改善の方向では、動的シナリオへの拡張が最も重要な課題です。
現在の静的な知識評価から、時系列データを用いた動的な判断能力評価への発展により、より現実的な運転場面での能力測定が可能になります。

数値推論と空間認識の弱点克服では、専用の前処理モジュールやハイブリッドアーキテクチャの開発により、これらの限界を補完する手法の研究が重要です。

国際展開の観点では、多国の交通法規への拡張により、グローバルな自動運転技術の標準の確立に貢献できます。
欧州、アジア各国の運転ルールを包含することで、国際的な技術互換性の向上が期待されます。

実用化への道筋では、商用自動運転システムへの統合が重要な展開です。
開発段階での能力評価ツールとしての活用や、運用中のシステム監視指標としての応用により、実際の安全性向上に直結する可能性があります。

研究基盤としての発展では、他の具体的ドメイン（医療、法務、教育など）での同様のベンチマーク構築の模範となり、AI能力評価の新しい標準を確立する可能性があります。

長期的には、人間の専門知識をAIシステムに効果的に転移する方法論の発展により、知識集約型タスクにおけるAI活用の新たな地平を開く可能性を秘めています。