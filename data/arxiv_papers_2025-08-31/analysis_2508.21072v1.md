# First-Place Solution to NeurIPS 2024 Invisible Watermark Removal Challenge

## 基本情報
- arXiv ID: 2508.21072v1 (https://arxiv.org/abs/2508.21072v1)
- 著者: Fahad Shamshad他（MBZUAI他）
- 所属: MBZUAI他
- 投稿日: 2025年08月31日
- カテゴリ: cs.CV, cs.AI

## 簡単に説明すると
この論文は、NeurIPS 2024の不可視透かし除去チャレンジで1位を獲得した解法を報告しています。生成AI時代における透かしのセキュリティ脆弱性を体系的に検証した研究です。ベージュボックス（アルゴリズムは既知だがパラメータは未知）とブラックボックス（多くの場合未知）の2つの脅威モデルで透かし除去手法を開発しました。VAEベース適応攻撃、空間変換による周波数ドメイン透かし除去、クラスタリングベースのブラックボックス戦略を組み合わせました。95.7%の透かし除去成功率を達成しながら画像品質をほぼ劣化させませんでした。この研究は透かし技術の根本的脆弱性を明らかにし、堅牢な透かし手法開発の必要性を示しています。

## 1. 研究概要
### 1.1 背景と動機
デジタルメディアの透かし技術は、認証・著作権保護・コンテンツトレーサビリティの重要な手段です。生成AIシステムが大規模で高品質な合成コンテンツを生成できる現在、透かしは不正配布や偽造対策の重要なセーフガードとして機能しています。

透かしシステムは意図しない歪み（ぼかし・リサイズなど）と、透かし信号を知覚的劣化なしに意図的に抑制する標的攻撃の両方に対して脆弱です。堅牢な透かしスキームは、除去成功が知覚的劣化を伴うことを保証します。最近の研究では、敵対者が適応攻撃・潜在空間の事前知識・単純な平均化技法を悪用して透かし信号を除去できる重大な脆弱性が露呈されています。

NeurIPS 2024の「Erasing the Invisible」チャレンジは、現実的脅威モデル下での不可視透かし手法の堅牢性を評価する厳密なベンチマークを提供しました。この研究では、2つの実用的脅威モデル下でこのチャレンジの1位解法を提示します。

### 1.2 主要な貢献
この研究の主要な技術的貢献は以下の4点です。

- ベージュボックスシナリオ向けの適応的VAEベース攻撃の設計。テスト時最適化と周波数認識による色彩復元を組み合わせた効果的な透かし除去手法
- TreeRingベース透かしに対する脆弱性の発見。位相摂動による空間変換が透かし信号を効果的に破壊することを実証
- ブラックボックス設定における標的クラスタ特化除去攻撃。画像を空間・スペクトル artifacts に基づいてグループ化し、拡散ベース浄化を適用
- セマンティックキャプションによる誘導拡散の活用。ChatGPT生成キャプションによる意味論的制約で高品質な透かしフリー再構築を実現

競技性能として、ベージュボックストラックで準優勝チームより26%、ブラックボックストラックで31.7%優れた検出スコアを達成しました。

## 2. 提案手法
### 2.1 手法の概要
この解法は適応的で手法特化の攻撃を採用し、汎用的な除去アプローチではなく戦略的フレームワークを構築しています。

ベージュボックス戦略では、既知アルゴリズムの悪用により透かし手法の部分的知識を活用します。StegaStampとTreeRingに対して専用の除去パイプラインを開発し、視覚的忠実度を維持するための後処理最適化を行います。

ブラックボックス戦略では、空間・周波数ドメイン署名による手動カテゴリ分類をします。クラスタ特化パラメータ最適化による拡散ベース浄化と、ChatGPT生成キャプションによるセマンティック誘導でコンテンツ保持を図ります。

評価は検出スコア（透かし除去成功度）と画像品質スコア（知覚的保持度）の2軸で行われました。検出スコアは0.1%偽陽性率での真陽性率、品質スコアは低レベル指標（PSNR、SSIM、NMI）と高レベル知覚指標（FID、CLIP-FID、LPIPS）の重み付き組み合わせです。

### 2.2 技術的詳細
StegaStamp透かし除去では3段階パイプラインを開発しました。まずペア化データセット生成では、1000個のテキストプロンプトからStable Diffusion 2-1で画像を生成します。各画像を100ビットバイナリメッセージとその逆でエンコードしてペアデータセットを作成します。

適応的VAE微調整の段階では、透かし画像とその逆メッセージ対応画像を用いて、以下のMSE損失でVAEを最適化しました。

```
L(θ,φ) = ||D_φ(E_θ(x_w)) - x_i||²₂
```

ここでE_θはエンコーダ、D_φはデコーダです。Adam最適化器（学習率1×10⁻⁵）で10エポック、バッチサイズ16で訓練し、勾配クリッピング（最大ノルム1.0）を適用しました。

品質保持の後処理では、テスト時VAE最適化とCIELAB色彩・コントラスト転送の2段階を実装しました。テスト時最適化では画像固有の最適化を行い、画素単位、知覚的（LPIPS）、構造的（SSIM）項を組み合わせた損失関数を使用しました。色彩・コントラスト転送では、最適化後の画像の輝度を保持し、元の透かし画像の色度成分を採用します。

TreeRing透かし除去では、周波数ドメインの位相摂動による脆弱性を発見しました。7画素の水平シフトによる空間変換がTreeRing埋め込みを効果的に破壊することを確認し、境界アーティファクト軽減のため左端7列を元画像から復元する手法を開発しました。

### 2.3 新規性
この研究の最も重要な技術的革新は、透かし手法の特定の脆弱性を悪用した適応攻撃の体系的開発です。単一の汎用アプローチではなく、各透かし手法の固有の弱点を標的とした特化型攻撃を設計しました。

VAEベースアプローチの新規性は、ペア化データセット生成による教師あり学習の活用にあります。同一画像に対する相反するメッセージの埋め込みにより、透かしアーティファクトを捉えたトレーニングデータを作成し、効果的な除去を実現しました。

CIELAB色空間での後処理は、知覚的に均一な色空間での独立した輝度・色度操作を可能にし、透かし信号を再導入することなく自然な外観を復元する点で革新的です。

ブラックボックス戦略では、観察可能な空間・周波数アーティファクトパターンに基づく手動クラスタリングアプローチが新規です。各クラスタに対して標的除去戦略を設計し、均一パラメータ設定よりも20%程度高い性能を実現しました。

## 3. 実験結果
### 3.1 実験設定
NeurIPS 2024競技は「Erasing the Invisible」チャレンジとして、現実的脅威モデル下での不可視透かし堅牢性を厳密に評価しました。各トラック300枚の透かし画像（総計600枚）で構成され、ベージュボックスはStegaStamp（150枚）とTreeRing（150枚）、ブラックボックスは観察可能アーティファクトを持つ未知アルゴリズムでした。

評価制約として、各トラックで1日最大5回のリーダーボード投稿が可能でした。検出スコアは10000枚のクリーン画像から設定された閾値での真陽性率（0.1%偽陽性率）で計算され、品質スコアは画素レベル指標（PSNR、SSIM、NMI）と知覚的指標（LPIPS、FID、CLIP-FID、Delta Aesthetics、Delta Artifacts）の重み付き組み合わせでした。

ベースライン手法との比較では、他の参加チームとの競争的評価により、提案手法の優位性を定量的に実証しました。アブレーション研究では、各コンポーネントの寄与を分離して分析し、設計選択の妥当性を検証しました。

### 3.2 主要な結果
競技リーダーボードでの圧倒的な性能を達成しました。

ブラックボックストラックでは、Team-MBZUAI（1位）が検出スコア0.043、品質スコア0.136、総合スコア0.143を記録しました。Team-SHARIF（2位）は0.063、0.158、0.170、Team-UFL（3位）は0.087、0.177、0.197でした。準優勝チームに対して検出スコアで31.7%の改善を達成しました。

ベージュボックストラックでは、Team-MBZUAI（1位）が検出スコア0.037、品質スコア0.153、総合スコア0.157を記録しました。Team-SONY（2位）は0.050、0.176、0.183、Team-SHARIF（3位）は0.127、0.222、0.256でした。準優勝チームに対して検出スコアで26%の改善を達成しました。

StegaStampパイプラインのアブレーション研究では、段階的な拡張の効果を確認しました。VAE微調整単独では検出スコア0.023、品質スコア0.192でした。テスト時最適化の追加で0.033、0.161となり、色彩・コントラスト転送で最終的に0.037、0.153を達成し、競技スコアリングに最適なバランスを実現しました。

### 3.3 既存手法との比較
包括的品質指標比較では、完全パイプラインがVAE微調整単独に対して大幅な改善を示しました。PSNRは21.899から28.061（+6.162 dB）、SSIMは0.647から0.823（+0.176）、LPIPSは0.264から0.078（-0.186）、FIDは85.383から30.786（-54.597）、CLIPFIDは11.805から2.831（-8.974）に改善しました。

拡散モデルパラメータ感度分析では、強度パラメータs≈0.10で急激なPSNR劣化（26→22 dB）の臨界閾値を発見しました。保守的設定（s=0.04）は細部を維持しつつ部分的除去を実現し、攻撃的設定（s=0.16-0.25）は強力な除去とセマンティック drift のリスクを伴います。

モデル比較では、stable-diffusion-xl-refiner-1.0が他の変種を一貫して上回りました。拡張ノイズ除去（100 vs 25ステップ）は限定的改善（約0.5 dB PSNR）を提供しました。

失敗した手法の分析では、ControlNetベースエッジ誘導、攻撃的拡散リンス、ホワイトボックスオーバーレイ摂動、未訓練の神経網再構築などの手法が効果的でなかった理由を体系的に説明しています。

## 4. 実用性評価
### 4.1 実装の容易性
技術的要件として、VAE微調整にNVIDIA A6000で2GPU時間未満、テスト時最適化に画像毎の精細化オーバーヘッド、拡散処理に画像毎500推論ステップ、手動クラスタリングに人間注釈が必要です。

スケーラビリティ評価では、VAE訓練と拡散処理は自動化コンポーネントとして拡張可能ですが、クラスタリングはアーティファクト識別のための人間検査を要求する手動ボトルネックです。標準的な深層学習インフラで十分であり、TreeRing攻撃は基本的な画像変換のみで実行可能です。

実用的な実装障壁として、ベージュボックス攻撃には透かしアルゴリズム識別の知識要件、VAE訓練のためのペアデータセット準備、クラスタ特化した最適化要件、除去効果と知覚保持のバランス取りが挙げられます。

### 4.2 計算効率
リソース要件は比較的合理的です。VAE微調整は2GPU時間未満、テスト時最適化は画像毎の追加処理、拡散モデルは標準的推論コストです。TreeRing攻撃は計算コストがほぼゼロで、単純な空間変換のみで実現できます。

ハードウェアアクセシビリティは標準的な深層学習インフラで十分であり、展開の単純性も確保されています。ただし品質制御として、除去効果と知覚保持のバランス調整が重要な考慮事項です。

競技制約下での性能として、1日5回の限定された評価機会の中で最適な結果を達成したことは、手法の信頼性を示しています。

### 4.3 応用可能性
即座のセキュリティ懸念として、現在の透かしシステムがAI生成コンテンツ検証に不十分な保護を提供することを実証しました。著作権保護の失敗と来歴追跡の妥協により、知的財産保護メカニズムと合成メディアでの信頼できるコンテンツ起源追跡が困難になります。

より広範なデジタルメディアセキュリティへの影響として、除去能力の向上が悪意あるコンテンツ配布を促進し、コンテンツ真正性と所有権の確立が困難になる可能性があります。規制上の含意として、透かしベースの規制の執行可能性に疑問が生じています。

将来の研究方向として、堅牢性を重視した設計、生成モデル統合、評価方法論、クロスメソッド検証が重要です。技術革新の駆動要因として、生成過程での統合戦略、マルチモーダル堅牢性、適応的防御メカニズム、プライバシー保護検証が挙げられます。

## 5. まとめと所感
### 5.1 論文の意義
この研究は透かしセキュリティ分野における重要な脆弱性評価の研稖です。現在の不可視透かしスキームが生成モデルアクセスを持つ適応敵対者に対して根本的脆弱性を持つことを体系的に実証しました。

競技コンテキストでの実用的検証により、現実的な制約下での標準化された評価指標を確立しました。複数の透かしパラダイムにわたる脆弱性の体系的暴露と、防御開発の明示的動機付けにより、研究コミュニティに重要な貢献を果たしています。

技術的革新レベルとして、手法に特化した適応攻撃、CIELAB色空間での品質保持の後処理、観察可能アーティファクトに基づくクラスタリング戦略において高い新規性を示しています。セマンティック誘導拡散による透かし除去も革新的なアプローチです。

競技性能として、両トラックでの圧倒的優勝（26%および31.7%の改善）は手法の優位性を明確に実証しています。

### 5.2 今後の展望
透かし堅牢性パラダイムの変化が必要です。破損堅牢性から適応攻撃耐性への脅威モデル拡張、透かし検証プロトコルでの敵対テスト組み込み、洗練された生成操作に対する透かし設計原則の確立が重要です。

将来の透かしへの技術要件として、拡散ベース浄化に対する生成モデル耐性、アルゴリズム詳細が既知でも保護を提供する知識非依存セキュリティ、手法特化悪用に対する適応攻撃耐性、不知覚性を犠牲にしない堅牢性維持が挙げられます。

実世界セキュリティ含意として、AI生成コンテンツ検証のための現在の透かしシステムが不十分な保護を提供し、知的財産保護メカニズムが弱体化され、合成メディアでの信頼できる起源追跡が困難になることを示しています。

この研究は建設的脆弱性研究として位置づけられ、堅牢な透かし設計の情報提供、現実的脅威モデルベースライン確立、攻撃促進よりも防御開発の動機付けを目的としています。透かしセキュリティの根本的再考と、高度な生成モデル時代における新たな防御戦略の開発の必要性を強く示唆する重要な研究です。